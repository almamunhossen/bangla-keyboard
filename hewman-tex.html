<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Text Refiner</title>
    <style>
        :root {
            --primary-color: #2C3E50;
            --secondary-color: #34495E;
            --accent-color: #2980B9;
            --background-color: #F8F9FA;
            --text-color: #2C3E50;
            --border-color: #ECF0F1;
            --hover-color: #2471A3;
        }

        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            margin: 0;
            padding: 2rem;
            line-height: 1.8;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 3rem;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 2.5rem;
            font-weight: 600;
            font-size: 2rem;
            border-bottom: 3px solid var(--border-color);
            padding-bottom: 1rem;
        }

        .toolbar {
            display: flex;
            gap: 1rem;
            margin: 2rem 0;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
        }

        button {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 0.9rem 1.8rem;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.2s ease;
            font-size: 1rem;
            font-weight: 500;
        }

        button:hover {
            background: var(--hover-color);
            transform: translateY(-2px);
        }

        select {
            padding: 0.9rem;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            background: white;
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-color);
        }

        textarea {
            width: 100%;
            height: 300px;
            padding: 1.5rem;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            resize: vertical;
            margin: 1.5rem 0;
            line-height: 1.8;
            background: #FBFCFD;
        }

        #outputText {
            min-height: 300px;
            background: #FBFCFD;
            padding: 1.8rem;
            border-radius: 8px;
            white-space: pre-wrap;
            border: 1px solid var(--border-color);
            font-size: 1rem;
            line-height: 1.8;
        }

        .stats-bar {
            display: flex;
            justify-content: space-between;
            margin: 1.5rem 0;
            color: #7F8C8D;
            font-size: 0.95rem;
            font-weight: 500;
        }

        .formatting-options {
            background: var(--background-color);
            padding: 1.5rem;
            border-radius: 8px;
            margin: 1.5rem 0;
            border: 1px solid var(--border-color);
        }

        .history-panel {
            margin-top: 2.5rem;
            border-top: 2px solid var(--border-color);
            padding-top: 1.5rem;
        }

        .loading-spinner {
            display: none;
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--accent-color);
            border-radius: 50%;
            width: 25px;
            height: 25px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        h3 {
            color: var(--primary-color);
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        h4 {
            color: var(--secondary-color);
            font-size: 1.2rem;
            margin-bottom: 1rem;
        }

        #historyList div {
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--border-color);
            font-size: 0.95rem;
        }

        #historyList div:last-child {
            border-bottom: none;
        }

        .text-area {
            display: flex;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Professional Text Refiner</h1>

        <div class="toolbar">
            <select id="formalityLevel">
                <option value="executive">Executive Level</option>
                <option value="business">Business Formal</option>
                <option value="technical">Technical Documentation</option>
                <option value="correspondence">Professional Correspondence</option>
                <option value="natural">Make it sound more natural and engaging</option>
                <option value="humor">Add humor and personal touch</option>
                <option value="diary">Make it sound like a personal diary entry</option>
            </select>
            <button onclick="refineText()">Refine Text</button>
            <button onclick="exportToDOC()">Export to DOC</button>
            <button onclick="toggleAdvanced()">Advanced Options</button>
            <button onclick="clearText()">Clear Text</button>
            <div class="loading-spinner" id="spinner"></div>
        </div>

        <div class="formatting-options" id="advancedOptions" style="display: none;">
            <label><input type="checkbox" id="grammarCheck"> Grammar Check</label>
            <label><input type="checkbox" id="consistencyCheck"> Style Consistency</label>
            <label><input type="checkbox" id="readabilityCheck"> Readability Optimize</label>
        </div>

        <div class="stats-bar">
            <span id="wordCount">Words: 0</span>
            <span id="readabilityScore">Readability: --</span>
            <span id="processingTime">Time: 0s</span>
        </div>

        <div class="text-area">
            <div>
                <textarea id="inputText" placeholder="Paste AI-generated content here..."></textarea>
            </div>

            <div>
                <h3>Refined Output:</h3>
                <div id="outputText"></div>
            </div>
        </div>
        <div class="history-panel">
            <h4>Revision History</h4>
            <div id="historyList"></div>
        </div>
    </div>

    <script>
        const professionalReplacements = {
            executive: [
                [/\boptimize\b/gi, 'enhance'],
                [/\bissue\b/gi, 'consideration'],
                [/\bmake sure\b/gi, 'ensure'],
                [/\bbad\b/gi, 'suboptimal'],
                [/\bthink\b/gi, 'strategize'],
                [/\bfix\b/gi, 'rectify'],
                [/\bproblem\b/gi, 'challenge'],
                [/\bcheap\b/gi, 'cost-effective'],
                [/\btry\b/gi, 'endeavor'],
                [/\bhelp\b/gi, 'assist'],
                [/\bbecause\b/gi, 'in light of']
            ],
            technical: [
                [/\buse\b/gi, 'utilize'],
                [/\bshow\b/gi, 'demonstrate'],
                [/\btell\b/gi, 'communicate'],
                [/\bget\b/gi, 'acquire'],
                [/\bbe sure\b/gi, 'verify'],
                [/\bneed\b/gi, 'require'],
                [/\bmake\b/gi, 'construct']
            ],
            natural: [
                [/\butilize\b/gi, 'use'],
                [/\bconstruct\b/gi, 'build'],
                [/\bendeavor\b/gi, 'try'],
                [/\bassist\b/gi, 'help'],
                [/\bsuboptimal\b/gi, 'not great']
            ],
            humor: [
                [/\boptimize\b/gi, 'jazz up'],
                [/\bchallenge\b/gi, 'pickle'],
                [/\brectify\b/gi, 'fix up'],
                [/\bstrategize\b/gi, 'plot like a mastermind'],
                [/\bcost-effective\b/gi, 'a steal']
            ],
            diary: [
                [/\bensure\b/gi, 'make sure (like I always do)'],
                [/\bconsideration\b/gi, 'something I thought about deeply'],
                [/\bassist\b/gi, 'lend a helping hand'],
                [/\brequire\b/gi, 'need (like coffee every morning)'],
                [/\bverify\b/gi, 'double-check (because Iâ€™m paranoid)']
            ]
        };

        let revisionHistory = [];
        let processingStartTime;

        function refineText() {
            processingStartTime = Date.now();
            toggleSpinner(true);

            const input = document.getElementById("inputText").value;
            const formality = document.getElementById("formalityLevel").value;

            let output = professionalTransform(input, formality);

            if (document.getElementById("grammarCheck").checked) {
                output = enhanceGrammar(output);
            }

            if (document.getElementById("readabilityCheck").checked) {
                output = improveReadability(output);
            }

            updateOutput(output);
            updateStats(input, output);
            addToHistory(output);
            toggleSpinner(false);
        }

        function professionalTransform(text, formality) {
            let processedText = text;

            if (professionalReplacements[formality]) {
                professionalReplacements[formality].forEach(([pattern, replacement]) => {
                    processedText = processedText.replace(pattern, replacement);
                });
            }

            return processedText;
        }

        function enhanceGrammar(text) {
            // Basic grammar enhancements
            return text
                .replace(/\bdon't\b/gi, 'do not')
                .replace(/\bcan't\b/gi, 'cannot')
                .replace(/\byou're\b/gi, 'you are')
                .replace(/\bi'm\b/gi, 'I am')
                .replace(/\.\s+([a-z])/g, (match) => match.toUpperCase());
        }

        function improveReadability(text) {
            // Split long sentences and paragraphs
            return text
                .replace(/([.?!])\s+(?=[A-Z])/g, '$1\n\n')
                .replace(/, ([a-z])/g, ', $1');
        }

        function updateOutput(text) {
            document.getElementById("outputText").innerText = text;
        }

        function updateStats(original, refined) {
            const timeElapsed = ((Date.now() - processingStartTime) / 1000).toFixed(2);
            document.getElementById("processingTime").textContent = `Time: ${timeElapsed}s`;

            const wordCount = refined.split(/\s+/).length;
            document.getElementById("wordCount").textContent = `Words: ${wordCount}`;
        }

        function addToHistory(text) {
            revisionHistory.push(text.slice(0, 100) + '...');
            document.getElementById("historyList").innerHTML = revisionHistory
                .map((entry, index) => `<div>${index + 1}. ${entry}</div>`)
                .join('');
        }

        function toggleSpinner(show) {
            document.getElementById("spinner").style.display = show ? 'inline-block' : 'none';
        }

        function toggleAdvanced() {
            const options = document.getElementById("advancedOptions");
            options.style.display = options.style.display === 'none' ? 'block' : 'none';
        }

        function exportToDOC() {
            const text = document.getElementById("outputText").innerText;
            const blob = new Blob([text], { type: 'application/msword' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'refined-document.doc';
            link.click();
        }

        function clearText() {
            document.getElementById("inputText").value = "";
            document.getElementById("outputText").innerText = "";
            document.getElementById("wordCount").textContent = "Words: 0";
            document.getElementById("processingTime").textContent = "Time: 0s";
        }

        // Initialize real-time word count
        document.getElementById("inputText").addEventListener("input", function (e) {
            const count = e.target.value.split(/\s+/).length;
            document.getElementById("wordCount").textContent = `Words: ${count}`;
        });
    </script>
</body>

</html>